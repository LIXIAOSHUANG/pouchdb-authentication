/*! pouchdb-authentication 2015-10-11 */
!function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);throw new Error("Cannot find module '"+g+"'")}var j=c[g]={exports:{}};b[g][0].call(j.exports,function(a){var c=b[g][1][a];return e(c?c:a)},j,j.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b,c){"use strict";function d(a){return function(b,c){return b&&"unknown_error"===b.name&&(b.message=(b.message||"")+" Unknown error!  Did you remember to enable CORS?"),a(b,c)}}function e(a){this.status=400,this.name="authentication_error",this.message=a,this.error=!0;try{Error.captureStackTrace(this,e)}catch(b){}}var f=a("./utils");c.signup=f.toPromise(function(a,b,c,g){var h=this;if("undefined"==typeof g&&(g="undefined"==typeof c?"undefined"==typeof b?a:b:c,c={}),-1===["http","https"].indexOf(h.type()))return g(new e('This plugin only works for the http/https adapter. So you should use new PouchDB("http://mysite.com:5984/mydb") instead.'));if(!a)return g(new e("You must provide a username"));if(!b)return g(new e("You must provide a password"));var i="org.couchdb.user:"+a,j={name:a,password:b,roles:c.roles||[],type:"user",_id:i},k=["name","password","roles","type","salt","metadata"];if(c.metadata){for(var l in c.metadata)if(c.hasOwnProperty(l)&&(-1!==k.indexOf(l)||l.startsWith("_")))return g(new e('cannot use reserved word in metadata: "'+l+'"'));j=f.extend(!0,j,c.metadata)}var m=f.getUsersUrl(h)+"/"+encodeURIComponent(i),n=f.extend(!0,{method:"PUT",url:m,body:j},c.ajax||{});f.ajax(n,d(g))}),c.signUp=c.signup,c.login=f.toPromise(function(a,b,c,g){var h=this;if("undefined"==typeof g&&(g=c,c={}),-1===["http","https"].indexOf(h.type()))return g(new e("this plugin only works for the http/https adapter"));if(!a)return g(new e("you must provide a username"));if(!b)return g(new e("you must provide a password"));var i="name="+a+"&password="+b,j=f.extend(!0,{headers:{Authorization:"Basic "+window.btoa(a+":"+b),"Content-Type":"application/x-www-form-urlencoded"},method:"POST",url:f.getSessionUrl(h),body:i},c.ajax||{});f.ajax(j,d(g))}),c.logIn=c.login,c.logout=f.toPromise(function(a,b){var c=this;"undefined"==typeof b&&(b=a,a={});var e=f.extend(!0,{method:"DELETE",url:f.getSessionUrl(c)},a.ajax||{});f.ajax(e,d(b))}),c.logOut=c.logout,c.getSession=f.toPromise(function(a,b){var c=this;"undefined"==typeof b&&(b=a,a={});var e=f.getSessionUrl(c),g=f.extend(!0,{method:"GET",url:e},a.ajax||{});f.ajax(g,d(b))}),c.getUser=f.toPromise(function(a,b,c){var g=this;if("undefined"==typeof c&&(c="undefined"==typeof b?a:b,b={}),!a)return c(new e("you must provide a username"));var h=f.getUsersUrl(g),i=f.extend(!0,{method:"GET",url:h+"/"+encodeURIComponent("org.couchdb.user:"+a)},b.ajax||{});f.ajax(i,d(c))}),c.changePassword=f.toPromise(function(a,b,c,g){var h=this;return"undefined"==typeof g&&(g="undefined"==typeof c?"undefined"==typeof b?a:b:c,c={}),-1===["http","https"].indexOf(h.type())?g(new e('This plugin only works for the http/https adapter. So you should use new PouchDB("http://mysite.com:5984/mydb") instead.')):a?b?h.getUser(a,c,function(a,e){if(a)return g(a);e.password=b;var i=f.getUsersUrl(h)+"/"+encodeURIComponent(e._id),j=f.extend(!0,{method:"PUT",url:i,body:e},c.ajax||{});f.ajax(j,d(g))}):g(new e("You must provide a password")):g(new e("You must provide a username"))}),f.inherits(e,Error),"undefined"!=typeof window&&window.PouchDB&&window.PouchDB.plugin(c)},{"./utils":2}],2:[function(a,b,c){(function(b){"use strict";function d(a){return a.getUrl().replace(/\/[^\/]+\/?$/,"")}var e=a("pouchdb/extras/promise");c.getUsersUrl=function(a){return d(a)+"/_users"},c.getSessionUrl=function(a){return d(a)+"/_session"},c.once=function(a){var b=!1;return c.getArguments(function(c){if(b)throw console.trace(),new Error("once called  more than once");b=!0,a.apply(this,c)})},c.getArguments=function(a){return function(){for(var b=arguments.length,c=new Array(b),d=-1;++d<b;)c[d]=arguments[d];return a.call(this,c)}},c.toPromise=function(a){return c.getArguments(function(d){var f,g=this,h="function"==typeof d[d.length-1]?d.pop():!1;h&&(f=function(a,c){b.nextTick(function(){h(a,c)})});var i=new e(function(b,e){try{var f=c.once(function(a,c){a?e(a):b(c)});d.push(f),a.apply(g,d)}catch(h){e(h)}});return f&&i.then(function(a){f(null,a)},f),i.cancel=function(){return this},i})},c.inherits=a("inherits"),c.extend=a("pouchdb-extend"),c.ajax=a("pouchdb/extras/ajax"),c.clone=function(a){return c.extend(!0,{},a)},c.uuid=a("./uuid"),c.Promise=e}).call(this,a("/Users/nolan/workspace/pouchdb-authentication/node_modules/browserify/node_modules/insert-module-globals/node_modules/process/browser.js"))},{"./uuid":3,"/Users/nolan/workspace/pouchdb-authentication/node_modules/browserify/node_modules/insert-module-globals/node_modules/process/browser.js":5,inherits:6,"pouchdb-extend":7,"pouchdb/extras/ajax":8,"pouchdb/extras/promise":9}],3:[function(a,b,c){"use strict";function d(a){return 0|Math.random()*a}function e(a,b){b=b||f.length;var c="",e=-1;if(a){for(;++e<a;)c+=f[d(b)];return c}for(;++e<36;)switch(e){case 8:case 13:case 18:case 23:c+="-";break;case 19:c+=f[3&d(16)|8];break;default:c+=f[d(16)]}return c}var f="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split("");b.exports=e},{}],4:[function(a,b,c){function d(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function e(a){return"function"==typeof a}function f(a){return"number"==typeof a}function g(a){return"object"==typeof a&&null!==a}function h(a){return void 0===a}b.exports=d,d.EventEmitter=d,d.prototype._events=void 0,d.prototype._maxListeners=void 0,d.defaultMaxListeners=10,d.prototype.setMaxListeners=function(a){if(!f(a)||0>a||isNaN(a))throw TypeError("n must be a positive number");return this._maxListeners=a,this},d.prototype.emit=function(a){var b,c,d,f,i,j;if(this._events||(this._events={}),"error"===a&&(!this._events.error||g(this._events.error)&&!this._events.error.length)){if(b=arguments[1],b instanceof Error)throw b;throw TypeError('Uncaught, unspecified "error" event.')}if(c=this._events[a],h(c))return!1;if(e(c))switch(arguments.length){case 1:c.call(this);break;case 2:c.call(this,arguments[1]);break;case 3:c.call(this,arguments[1],arguments[2]);break;default:for(d=arguments.length,f=new Array(d-1),i=1;d>i;i++)f[i-1]=arguments[i];c.apply(this,f)}else if(g(c)){for(d=arguments.length,f=new Array(d-1),i=1;d>i;i++)f[i-1]=arguments[i];for(j=c.slice(),d=j.length,i=0;d>i;i++)j[i].apply(this,f)}return!0},d.prototype.addListener=function(a,b){var c;if(!e(b))throw TypeError("listener must be a function");if(this._events||(this._events={}),this._events.newListener&&this.emit("newListener",a,e(b.listener)?b.listener:b),this._events[a]?g(this._events[a])?this._events[a].push(b):this._events[a]=[this._events[a],b]:this._events[a]=b,g(this._events[a])&&!this._events[a].warned){var c;c=h(this._maxListeners)?d.defaultMaxListeners:this._maxListeners,c&&c>0&&this._events[a].length>c&&(this._events[a].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[a].length),"function"==typeof console.trace&&console.trace())}return this},d.prototype.on=d.prototype.addListener,d.prototype.once=function(a,b){function c(){this.removeListener(a,c),d||(d=!0,b.apply(this,arguments))}if(!e(b))throw TypeError("listener must be a function");var d=!1;return c.listener=b,this.on(a,c),this},d.prototype.removeListener=function(a,b){var c,d,f,h;if(!e(b))throw TypeError("listener must be a function");if(!this._events||!this._events[a])return this;if(c=this._events[a],f=c.length,d=-1,c===b||e(c.listener)&&c.listener===b)delete this._events[a],this._events.removeListener&&this.emit("removeListener",a,b);else if(g(c)){for(h=f;h-->0;)if(c[h]===b||c[h].listener&&c[h].listener===b){d=h;break}if(0>d)return this;1===c.length?(c.length=0,delete this._events[a]):c.splice(d,1),this._events.removeListener&&this.emit("removeListener",a,b)}return this},d.prototype.removeAllListeners=function(a){var b,c;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[a]&&delete this._events[a],this;if(0===arguments.length){for(b in this._events)"removeListener"!==b&&this.removeAllListeners(b);return this.removeAllListeners("removeListener"),this._events={},this}if(c=this._events[a],e(c))this.removeListener(a,c);else for(;c.length;)this.removeListener(a,c[c.length-1]);return delete this._events[a],this},d.prototype.listeners=function(a){var b;return b=this._events&&this._events[a]?e(this._events[a])?[this._events[a]]:this._events[a].slice():[]},d.listenerCount=function(a,b){var c;return c=a._events&&a._events[b]?e(a._events[b])?1:a._events[b].length:0}},{}],5:[function(a,b,c){function d(){}var e=b.exports={};e.nextTick=function(){var a="undefined"!=typeof window&&window.setImmediate,b="undefined"!=typeof window&&window.postMessage&&window.addEventListener;if(a)return function(a){return window.setImmediate(a)};if(b){var c=[];return window.addEventListener("message",function(a){var b=a.source;if((b===window||null===b)&&"process-tick"===a.data&&(a.stopPropagation(),c.length>0)){var d=c.shift();d()}},!0),function(a){c.push(a),window.postMessage("process-tick","*")}}return function(a){setTimeout(a,0)}}(),e.title="browser",e.browser=!0,e.env={},e.argv=[],e.on=d,e.once=d,e.off=d,e.emit=d,e.binding=function(a){throw new Error("process.binding is not supported")},e.cwd=function(){return"/"},e.chdir=function(a){throw new Error("process.chdir is not supported")}},{}],6:[function(a,b,c){"function"==typeof Object.create?b.exports=function(a,b){a.super_=b,a.prototype=Object.create(b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}})}:b.exports=function(a,b){a.super_=b;var c=function(){};c.prototype=b.prototype,a.prototype=new c,a.prototype.constructor=a}},{}],7:[function(a,b,c){"use strict";function d(a){return null===a?String(a):"object"==typeof a||"function"==typeof a?j[n.call(a)]||"object":typeof a}function e(a){return null!==a&&a===a.window}function f(a){if(!a||"object"!==d(a)||a.nodeType||e(a))return!1;try{if(a.constructor&&!o.call(a,"constructor")&&!o.call(a.constructor.prototype,"isPrototypeOf"))return!1}catch(b){return!1}var c;for(c in a);return void 0===c||o.call(a,c)}function g(a){return"function"===d(a)}function h(){for(var a=[],b=-1,c=arguments.length,d=new Array(c);++b<c;)d[b]=arguments[b];var e={};a.push({args:d,result:{container:e,key:"key"}});for(var f;f=a.pop();)i(a,f.args,f.result);return e.key}function i(a,b,c){var d,e,h,i,j,k,l,m=b[0]||{},n=1,o=b.length,q=!1,r=/\d+/;for("boolean"==typeof m&&(q=m,m=b[1]||{},n=2),"object"==typeof m||g(m)||(m={}),o===n&&(m=this,--n);o>n;n++)if(null!=(d=b[n])){l=p(d);for(e in d)if(!(e in Object.prototype)){if(l&&!r.test(e))continue;if(h=m[e],i=d[e],m===i)continue;q&&i&&(f(i)||(j=p(i)))?(j?(j=!1,k=h&&p(h)?h:[]):k=h&&f(h)?h:{},a.push({args:[q,k,i],result:{container:m,key:e}})):void 0!==i&&(p(d)&&g(i)||(m[e]=i))}}c.container[c.key]=m}for(var j={},k=["Boolean","Number","String","Function","Array","Date","RegExp","Object","Error"],l=0;l<k.length;l++){var m=k[l];j["[object "+m+"]"]=m.toLowerCase()}var n=j.toString,o=j.hasOwnProperty,p=Array.isArray||function(a){return"array"===d(a)};b.exports=h},{}],8:[function(a,b,c){"use strict";b.exports=a("../lib/deps/ajax/ajaxCore")},{"../lib/deps/ajax/ajaxCore":11}],9:[function(a,b,c){"use strict";b.exports=a("../lib/deps/promise")},{"../lib/deps/promise":34}],10:[function(a,b,c){"use strict";function d(a){h()?chrome.storage.onChanged.addListener(function(b){null!=b.db_name&&a.emit(b.dbName.newValue)}):i()&&("undefined"!=typeof addEventListener?addEventListener("storage",function(b){a.emit(b.key)}):window.attachEvent("storage",function(b){a.emit(b.key)}))}function e(){f.call(this),this._listeners={},d(this)}var f=a("events").EventEmitter,g=a("inherits"),h=a("./deps/env/isChromeApp"),i=a("./deps/env/hasLocalStorage"),j=a("./deps/pick");g(e,f),e.prototype.addListener=function(a,b,c,d){function e(){if(f._listeners[b]){if(g)return void(g="waiting");g=!0;var a=j(d,["style","include_docs","attachments","conflicts","filter","doc_ids","view","since","query_params","binary"]);c.changes(a).on("change",function(a){a.seq>d.since&&!d.cancelled&&(d.since=a.seq,d.onChange(a))}).on("complete",function(){"waiting"===g&&setTimeout(function(){e()},0),g=!1}).on("error",function(){g=!1})}}if(!this._listeners[b]){var f=this,g=!1;this._listeners[b]=e,this.on(a,e)}},e.prototype.removeListener=function(a,b){b in this._listeners&&f.prototype.removeListener.call(this,a,this._listeners[b])},e.prototype.notifyLocalWindows=function(a){h()?chrome.storage.local.set({dbName:a}):i()&&(localStorage[a]="a"===localStorage[a]?"b":"a")},e.prototype.notify=function(a){this.emit(a),this.notifyLocalWindows(a)},b.exports=e},{"./deps/env/hasLocalStorage":26,"./deps/env/isChromeApp":27,"./deps/pick":33,events:4,inherits:6}],11:[function(a,b,c){"use strict";function d(a,b){function c(b,c,d){if(a.binary||a.json||!a.processData||"string"==typeof b){if(!a.binary&&a.json&&"string"==typeof b)try{b=JSON.parse(b)}catch(e){return d(e)}}else b=JSON.stringify(b);Array.isArray(b)&&(b=b.map(function(a){return a.error||a.missing?f.generateErrorFromResponse(a):a})),a.binary&&h(b,c),d(null,b,c)}function d(a,b){var c,d;if(a.code&&a.status){var e=new Error(a.message||a.code);return e.status=a.status,b(e)}try{c=JSON.parse(a.responseText),d=f.generateErrorFromResponse(c)}catch(g){d=f.generateErrorFromResponse(a)}b(d)}a=g.clone(a);var k={method:"GET",headers:{},json:!0,processData:!0,timeout:1e4,cache:!1};return a=g.extend(k,a),a.json&&(a.binary||(a.headers.Accept="application/json"),a.headers["Content-Type"]=a.headers["Content-Type"]||"application/json"),a.binary&&(a.encoding=null,a.json=!1),a.processData||(a.json=!1),e(a,function(e,g,h){if(e){if(g){var k="undefined"!=typeof document&&document.location.origin,l=k&&0===a.url.indexOf(k);l&&0===g.statusCode&&j(),e.status=g.statusCode}else e.status=400;return d(e,b)}var m,n=g.headers&&g.headers["content-type"],o=h||i();if(!a.binary&&(a.json||!a.processData)&&"object"!=typeof o&&(/json/.test(n)||/^[\s]*\{/.test(o)&&/\}[\s]*$/.test(o)))try{o=JSON.parse(o.toString())}catch(p){}g.statusCode>=200&&g.statusCode<300?c(o,g,b):(m=f.generateErrorFromResponse(o),m.status=g.statusCode,b(m))})}var e=a("request"),f=a("./../errors"),g=a("../../utils"),h=a("./applyTypeToBuffer"),i=a("./defaultBody"),j=a("./explainCors");b.exports=d},{"../../utils":37,"./../errors":28,"./applyTypeToBuffer":12,"./defaultBody":13,"./explainCors":15,request:17}],12:[function(a,b,c){"use strict";b.exports=function(){}},{}],13:[function(a,b,c){"use strict";b.exports=function(){return""}},{}],14:[function(a,b,c){(function(a){"use strict";b.exports=function(b){"console"in a&&"info"in console&&console.info("The above 404 is totally normal. "+b)}}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],15:[function(a,b,c){(function(a){"use strict";b.exports=function(){"console"in a&&"warn"in console&&console.warn("PouchDB: the remote database may not have CORS enabled.If not please enable CORS: http://pouchdb.com/errors.html#no_access_control_allow_origin_header")}}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],16:[function(a,b,c){"use strict";var d=a("./ajaxCore");b.exports=function(a,b){if(("POST"===a.method||"GET"===a.method)&&!a.cache){var c=-1!==a.url.indexOf("?");a.url+=(c?"&":"?")+"_nonce="+Date.now()}return d(a,b)}},{"./ajaxCore":11}],17:[function(a,b,c){"use strict";function d(){for(var a={},b=new i.Promise(function(b,c){a.resolve=b,a.reject=c}),c=new Array(arguments.length),d=0;d<c.length;d++)c[d]=arguments[d];return a.promise=b,i.Promise.resolve().then(function(){return fetch.apply(null,c)}).then(function(b){a.resolve(b)})["catch"](function(b){a.reject(b)}),a}function e(a,b){var c,e,f,g=new Headers,h={method:a.method,credentials:"include",headers:g};return a.json&&(g.set("Accept","application/json"),g.set("Content-Type",a.headers["Content-Type"]||"application/json")),a.body&&a.body instanceof Blob?j(a.body,function(a){h.body=a}):a.body&&a.processData&&"string"!=typeof a.body?h.body=JSON.stringify(a.body):"body"in a?h.body=a.body:h.body=null,Object.keys(a.headers).forEach(function(b){a.headers.hasOwnProperty(b)&&g.set(b,a.headers[b])}),c=d(a.url,h),a.timeout>0&&(e=setTimeout(function(){c.reject(new Error("Load timeout for resource: "+a.url))},a.timeout)),c.promise.then(function(b){return f={statusCode:b.status},a.timeout>0&&clearTimeout(e),f.statusCode>=200&&f.statusCode<300?a.binary?b.blob():b.text():b.json()}).then(function(a){f.statusCode>=200&&f.statusCode<300?b(null,f,a):b(a,f)})["catch"](function(a){b(a,f)}),{abort:c.reject}}function f(a,b){var c,d,e,f=function(){c.abort()};c=a.xhr?new a.xhr:new XMLHttpRequest,c.open(a.method,a.url),c.withCredentials=!0,"GET"===a.method?delete a.headers["Content-Type"]:a.json&&(a.headers.Accept="application/json",a.headers["Content-Type"]=a.headers["Content-Type"]||"application/json",a.body&&a.processData&&"string"!=typeof a.body&&(a.body=JSON.stringify(a.body))),a.binary&&(c.responseType="arraybuffer"),"body"in a||(a.body=null);for(var g in a.headers)a.headers.hasOwnProperty(g)&&c.setRequestHeader(g,a.headers[g]);return a.timeout>0&&(d=setTimeout(f,a.timeout),c.onprogress=function(){clearTimeout(d),d=setTimeout(f,a.timeout)},"undefined"==typeof e&&(e=-1!==Object.keys(c).indexOf("upload")&&"undefined"!=typeof c.upload),e&&(c.upload.onprogress=c.onprogress)),c.onreadystatechange=function(){if(4===c.readyState){var d={statusCode:c.status};if(c.status>=200&&c.status<300){var e;e=a.binary?h([c.response||""],{type:c.getResponseHeader("Content-Type")}):c.responseText,b(null,d,e)}else{var f={};try{f=JSON.parse(c.response)}catch(g){}b(f,d)}}},a.body&&a.body instanceof Blob?j(a.body,function(a){c.send(a)}):c.send(a.body),{abort:f}}function g(){try{return new XMLHttpRequest,!0}catch(a){return!1}}var h=a("./../binary/blob.js"),i=a("../../utils"),j=a("./../binary/readAsArrayBuffer"),k=g();b.exports=function(a,b){return k||a.xhr?f(a,b):e(a,b)}},{"../../utils":37,"./../binary/blob.js":21,"./../binary/readAsArrayBuffer":23}],18:[function(a,b,c){"use strict";var d=a("./buffer");"function"==typeof atob?c.atob=function(a){return atob(a)}:c.atob=function(a){var b=new d(a,"base64");if(b.toString("base64")!==a)throw"Cannot base64 encode full string";return b.toString("binary")},"function"==typeof btoa?c.btoa=function(a){return btoa(a)}:c.btoa=function(a){return new d(a,"binary").toString("base64")}},{"./buffer":22}],19:[function(a,b,c){"use strict";b.exports=function(a){for(var b=a.length,c=new ArrayBuffer(b),d=new Uint8Array(c),e=0;b>e;e++)d[e]=a.charCodeAt(e);return c}},{}],20:[function(a,b,c){"use strict";var d=a("./blob"),e=a("./binaryStringToArrayBuffer");b.exports=function(a,b){return d([e(a)],{type:b})}},{"./binaryStringToArrayBuffer":19,"./blob":21}],21:[function(a,b,c){"use strict";function d(a,b){a=a||[],b=b||{};try{return new Blob(a,b)}catch(c){if("TypeError"!==c.name)throw c;for(var d="undefined"!=typeof BlobBuilder?BlobBuilder:"undefined"!=typeof MSBlobBuilder?MSBlobBuilder:"undefined"!=typeof MozBlobBuilder?MozBlobBuilder:WebKitBlobBuilder,e=new d,f=0;f<a.length;f+=1)e.append(a[f]);return e.getBlob(b.type)}}b.exports=d},{}],22:[function(a,b,c){b.exports={}},{}],23:[function(a,b,c){"use strict";b.exports=function(a,b){var c=new FileReader;c.onloadend=function(a){var c=a.target.result||new ArrayBuffer(0);b(c)},c.readAsArrayBuffer(a)}},{}],24:[function(a,b,c){"use strict";function d(a){if("function"!=typeof a.hasOwnProperty)return!1;var b;for(b in a);return void 0===b||a.hasOwnProperty(b)}b.exports=function e(a){var b,c,f;if(!a||"object"!=typeof a)return a;if(Array.isArray(a)){for(b=[],c=0,f=a.length;f>c;c++)b[c]=e(a[c]);return b}if(a instanceof Date)return a.toISOString();if(!d(a))return a;b={};for(c in a)if(a.hasOwnProperty(c)){var g=e(a[c]);"undefined"!=typeof g&&(b[c]=g)}return b}},{}],25:[function(a,b,c){"use strict";function d(a){return a.reduce(function(a,b){return a[b]=!0,a},{})}function e(a){if(!/^\d+\-./.test(a))return g.error(g.INVALID_REV);var b=a.indexOf("-"),c=a.substring(0,b),d=a.substring(b+1);return{prefix:parseInt(c,10),id:d}}function f(a,b){for(var c=a.start-a.ids.length+1,d=a.ids,e=[d[0],b,[]],f=1,g=d.length;g>f;f++)e=[d[f],{status:"missing"},[e]];return[{pos:c,ids:e}]}var g=a("./../errors"),h=a("./../uuid"),i=d(["_id","_rev","_attachments","_deleted","_revisions","_revs_info","_conflicts","_deleted_conflicts","_local_seq","_rev_tree","_replication_id","_replication_state","_replication_state_time","_replication_state_reason","_replication_stats","_removed"]),j=d(["_attachments","_replication_id","_replication_state","_replication_state_time","_replication_state_reason","_replication_stats"]);c.invalidIdError=function(a){var b;if(a?"string"!=typeof a?b=g.error(g.INVALID_ID):/^_/.test(a)&&!/^_(design|local)/.test(a)&&(b=g.error(g.RESERVED_ID)):b=g.error(g.MISSING_ID),b)throw b},c.parseDoc=function(a,b){var d,k,l,m={status:"available"};if(a._deleted&&(m.deleted=!0),b)if(a._id||(a._id=h()),k=h(32,16).toLowerCase(),a._rev){if(l=e(a._rev),l.error)return l;a._rev_tree=[{pos:l.prefix,ids:[l.id,{status:"missing"},[[k,m,[]]]]}],d=l.prefix+1}else a._rev_tree=[{pos:1,ids:[k,m,[]]}],d=1;else if(a._revisions&&(a._rev_tree=f(a._revisions,m),d=a._revisions.start,k=a._revisions.ids[0]),!a._rev_tree){if(l=e(a._rev),l.error)return l;d=l.prefix,k=l.id,a._rev_tree=[{pos:d,ids:[k,m,[]]}]}c.invalidIdError(a._id),a._rev=d+"-"+k;var n={metadata:{},data:{}};for(var o in a)if(Object.prototype.hasOwnProperty.call(a,o)){var p="_"===o[0];if(p&&!i[o]){var q=g.error(g.DOC_VALIDATION,o);throw q.message=g.DOC_VALIDATION.message+": "+o,q}p&&!j[o]?n.metadata[o.slice(1)]=a[o]:n.data[o]=a[o]}return n}},{"./../errors":28,"./../uuid":36}],26:[function(a,b,c){"use strict";var d,e=a("./isChromeApp");if(e())d=!1;else try{localStorage.setItem("_pouch_check_localstorage",1),d=!!localStorage.getItem("_pouch_check_localstorage")}catch(f){d=!1}b.exports=function(){return d}},{"./isChromeApp":27}],27:[function(a,b,c){"use strict";b.exports=function(){return"undefined"!=typeof chrome&&"undefined"!=typeof chrome.storage&&"undefined"!=typeof chrome.storage.local}},{}],28:[function(a,b,c){"use strict";function d(a){Error.call(this,a.reason),this.status=a.status,this.name=a.error,this.message=a.reason,this.error=!0}var e=a("inherits");e(d,Error),d.prototype.toString=function(){return JSON.stringify({status:this.status,name:this.name,message:this.message})},c.UNAUTHORIZED=new d({status:401,error:"unauthorized",reason:"Name or password is incorrect."}),c.MISSING_BULK_DOCS=new d({status:400,error:"bad_request",reason:"Missing JSON list of 'docs'"}),c.MISSING_DOC=new d({status:404,error:"not_found",reason:"missing"}),c.REV_CONFLICT=new d({status:409,error:"conflict",reason:"Document update conflict"}),c.INVALID_ID=new d({status:400,error:"invalid_id",reason:"_id field must contain a string"}),c.MISSING_ID=new d({status:412,error:"missing_id",reason:"_id is required for puts"}),c.RESERVED_ID=new d({status:400,error:"bad_request",reason:"Only reserved document ids may start with underscore."}),c.NOT_OPEN=new d({status:412,error:"precondition_failed",reason:"Database not open"}),c.UNKNOWN_ERROR=new d({status:500,error:"unknown_error",reason:"Database encountered an unknown error"}),c.BAD_ARG=new d({status:500,error:"badarg",reason:"Some query argument is invalid"}),c.INVALID_REQUEST=new d({status:400,error:"invalid_request",reason:"Request was invalid"}),c.QUERY_PARSE_ERROR=new d({status:400,error:"query_parse_error",reason:"Some query parameter is invalid"}),c.DOC_VALIDATION=new d({status:500,error:"doc_validation",reason:"Bad special document member"}),c.BAD_REQUEST=new d({status:400,error:"bad_request",reason:"Something wrong with the request"}),c.NOT_AN_OBJECT=new d({status:400,error:"bad_request",reason:"Document must be a JSON object"}),c.DB_MISSING=new d({status:404,error:"not_found",reason:"Database not found"}),c.IDB_ERROR=new d({status:500,error:"indexed_db_went_bad",reason:"unknown"}),c.WSQ_ERROR=new d({status:500,error:"web_sql_went_bad",reason:"unknown"}),c.LDB_ERROR=new d({status:500,error:"levelDB_went_went_bad",reason:"unknown"}),c.FORBIDDEN=new d({status:403,error:"forbidden",reason:"Forbidden by design doc validate_doc_update function"}),c.INVALID_REV=new d({status:400,error:"bad_request",reason:"Invalid rev format"}),c.FILE_EXISTS=new d({status:412,error:"file_exists",reason:"The database could not be created, the file already exists."}),c.MISSING_STUB=new d({status:412,error:"missing_stub"}),c.error=function(a,b,c){function e(b){for(var d in a)"function"!=typeof a[d]&&(this[d]=a[d]);void 0!==c&&(this.name=c),void 0!==b&&(this.reason=b)}return e.prototype=d.prototype,new e(b)},c.getErrorTypeByProp=function(a,b,d){var e=c,f=Object.keys(e).filter(function(c){var d=e[c];return"function"!=typeof d&&d[a]===b}),g=d&&f.filter(function(a){var b=e[a];return b.message===d})[0]||f[0];return g?e[g]:null},c.generateErrorFromResponse=function(a){var b,d,e,f,g,h=c;return d=a.error===!0&&"string"==typeof a.name?a.name:a.error,g=a.reason,e=h.getErrorTypeByProp("name",d,g),a.missing||"missing"===g||"deleted"===g||"not_found"===d?e=h.MISSING_DOC:"doc_validation"===d?(e=h.DOC_VALIDATION,f=g):"bad_request"===d&&e.message!==g&&(e=h.BAD_REQUEST),e||(e=h.getErrorTypeByProp("status",a.status,g)||h.UNKNOWN_ERROR),b=h.error(e,g,d),f&&(b.message=f),a.id&&(b.id=a.id),a.status&&(b.status=a.status),a.missing&&(b.missing=a.missing),b}},{inherits:6}],29:[function(a,b,c){"use strict";function d(a,b){for(var c in b)if(b.hasOwnProperty(c)){var d=e(b[c]);"undefined"!=typeof d&&(a[c]=d)}}var e=a("./clone");b.exports=function(a,b,c){return d(a,b),c&&d(a,c),a}},{"./clone":24}],30:[function(a,b,c){"use strict";b.exports=function(a,b){for(var c,d=a.slice();c=d.pop();)for(var e=c.pos,f=c.ids,g=f[2],h=b(0===g.length,e,f[0],c.ctx,f[1]),i=0,j=g.length;j>i;i++)d.push({pos:e+1,ids:g[i],ctx:h})}},{}],31:[function(a,b,c){"use strict";function d(a){var b=!1;return e(function(c){if(b)throw new Error("once called more than once");b=!0,a.apply(this,c)})}var e=a("argsarray");b.exports=d},{argsarray:38}],32:[function(a,b,c){"use strict";function d(a){for(var b=h.exec(a),c={},d=14;d--;){var i=e[d],j=b[d]||"",k=-1!==["user","password"].indexOf(i);c[i]=k?decodeURIComponent(j):j}return c[f]={},c[e[12]].replace(g,function(a,b,d){b&&(c[f][b]=d)}),c}var e=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],f="queryKey",g=/(?:^|&)([^&=]*)=?([^&]*)/g,h=/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/;b.exports=d},{}],33:[function(a,b,c){"use strict";b.exports=function(a,b){for(var c={},d=0,e=b.length;e>d;d++){var f=b[d];f in a&&(c[f]=a[f])}return c}},{}],34:[function(a,b,c){"use strict";b.exports="function"==typeof Promise?Promise:a("lie")},{lie:42}],35:[function(a,b,c){(function(c){"use strict";function d(a){return f(function(b){var d,f=this,h="function"==typeof b[b.length-1]?b.pop():!1;h&&(d=function(a,b){c.nextTick(function(){h(a,b)})});var i=new e(function(c,d){var e;try{var h=g(function(a,b){a?d(a):c(b)});b.push(h),e=a.apply(f,b),e&&"function"==typeof e.then&&c(e)}catch(i){d(i)}});return d&&i.then(function(a){d(null,a)},d),i})}var e=a("./promise"),f=a("argsarray"),g=a("./once");b.exports=d}).call(this,a("/Users/nolan/workspace/pouchdb-authentication/node_modules/browserify/node_modules/insert-module-globals/node_modules/process/browser.js"))},{"./once":31,"./promise":34,"/Users/nolan/workspace/pouchdb-authentication/node_modules/browserify/node_modules/insert-module-globals/node_modules/process/browser.js":5,argsarray:38}],36:[function(a,b,c){b.exports=a(3)},{}],37:[function(a,b,c){function d(a,b,c){try{return!a(b,c)}catch(d){var e="Filter function threw: "+d.toString();return j.error(j.BAD_REQUEST,e)}}var e=a("./deps/merge/traverseRevTree");c.ajax=a("./deps/ajax/prequest"),c.uuid=a("./deps/uuid"),c.getArguments=a("argsarray");var f=a("pouchdb-collections");c.Map=f.Map,c.Set=f.Set;var g=a("./deps/docs/parseDoc"),h=a("./deps/promise");c.Promise=h;var i=a("./deps/binary/base64"),j=a("./deps/errors");c.atob=i.atob,c.btoa=i.btoa;var k=a("./deps/binary/binaryStringToBlobOrBuffer");c.binaryStringToBlobOrBuffer=k,c.clone=a("./deps/clone"),c.extend=a("./deps/extend"),c.pick=a("./deps/pick"),c.inherits=a("inherits"),c.filterChange=function(a){var b={},c=a.filter&&"function"==typeof a.filter;return b.query=a.query_params,function(e){e.doc||(e.doc={});var f=c&&d(a.filter,e.doc,b);if("object"==typeof f)return f;if(f)return!1;if(a.include_docs){if(!a.attachments)for(var g in e.doc._attachments)e.doc._attachments.hasOwnProperty(g)&&(e.doc._attachments[g].stub=!0)}else delete e.doc;return!0}},c.parseDoc=g.parseDoc,c.invalidIdError=g.invalidIdError,c.isCordova=function(){return"undefined"!=typeof cordova||"undefined"!=typeof PhoneGap||"undefined"!=typeof phonegap},c.Changes=a("./changesHandler"),c.once=a("./deps/once"),c.toPromise=a("./deps/toPromise"),c.adapterFun=function(b,d){function e(a,b,c){if(f.enabled){for(var d=[a._db_name,b],e=0;e<c.length-1;e++)d.push(c[e]);f.apply(null,d);var g=c[c.length-1];c[c.length-1]=function(c,d){var e=[a._db_name,b];e=e.concat(c?["error",c]:["success",d]),f.apply(null,e),g(c,d)}}}var f=a("debug")("pouchdb:api");return c.toPromise(c.getArguments(function(a){if(this._closed)return h.reject(new Error("database is closed"));var c=this;return e(c,b,a),this.taskqueue.isReady?d.apply(this,a):new h(function(d,e){c.taskqueue.addTask(function(f){f?e(f):d(c[b].apply(c,a))})})}))},c.explain404=a("./deps/ajax/explain404"),c.parseUri=a("./deps/parseUri"),c.compare=function(a,b){return b>a?-1:a>b?1:0},c.compactTree=function(a){var b=[];return e(a.rev_tree,function(a,c,d,e,f){"available"!==f.status||a||(b.push(c+"-"+d),f.status="missing")}),b};var l=a("vuvuzela");c.safeJsonParse=function(a){try{return JSON.parse(a)}catch(b){return l.parse(a)}},c.safeJsonStringify=function(a){try{return JSON.stringify(a)}catch(b){return l.stringify(a)}}},{"./changesHandler":10,"./deps/ajax/explain404":14,"./deps/ajax/prequest":16,"./deps/binary/base64":18,"./deps/binary/binaryStringToBlobOrBuffer":20,"./deps/clone":24,"./deps/docs/parseDoc":25,"./deps/errors":28,"./deps/extend":29,"./deps/merge/traverseRevTree":30,"./deps/once":31,"./deps/parseUri":32,"./deps/pick":33,"./deps/promise":34,"./deps/toPromise":35,"./deps/uuid":36,argsarray:38,debug:39,inherits:6,"pouchdb-collections":44,vuvuzela:45}],38:[function(a,b,c){"use strict";function d(a){return function(){var b=arguments.length;if(b){for(var c=[],d=-1;++d<b;)c[d]=arguments[d];return a.call(this,c)}return a.call(this,[])}}b.exports=d},{}],39:[function(a,b,c){function d(){return"WebkitAppearance"in document.documentElement.style||window.console&&(console.firebug||console.exception&&console.table)||navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31}function e(){var a=arguments,b=this.useColors;if(a[0]=(b?"%c":"")+this.namespace+(b?" %c":" ")+a[0]+(b?"%c ":" ")+"+"+c.humanize(this.diff),!b)return a;var d="color: "+this.color;a=[a[0],d,"color: inherit"].concat(Array.prototype.slice.call(a,1));var e=0,f=0;return a[0].replace(/%[a-z%]/g,function(a){"%%"!==a&&(e++,"%c"===a&&(f=e))}),a.splice(f,0,d),a}function f(){return"object"==typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)}function g(a){try{null==a?c.storage.removeItem("debug"):c.storage.debug=a}catch(b){}}function h(){var a;try{a=c.storage.debug}catch(b){}return a;
}function i(){try{return window.localStorage}catch(a){}}c=b.exports=a("./debug"),c.log=f,c.formatArgs=e,c.save=g,c.load=h,c.useColors=d,c.storage="undefined"!=typeof chrome&&"undefined"!=typeof chrome.storage?chrome.storage.local:i(),c.colors=["lightseagreen","forestgreen","goldenrod","dodgerblue","darkorchid","crimson"],c.formatters.j=function(a){return JSON.stringify(a)},c.enable(h())},{"./debug":40}],40:[function(a,b,c){function d(){return c.colors[k++%c.colors.length]}function e(a){function b(){}function e(){var a=e,b=+new Date,f=b-(j||b);a.diff=f,a.prev=j,a.curr=b,j=b,null==a.useColors&&(a.useColors=c.useColors()),null==a.color&&a.useColors&&(a.color=d());var g=Array.prototype.slice.call(arguments);g[0]=c.coerce(g[0]),"string"!=typeof g[0]&&(g=["%o"].concat(g));var h=0;g[0]=g[0].replace(/%([a-z%])/g,function(b,d){if("%%"===b)return b;h++;var e=c.formatters[d];if("function"==typeof e){var f=g[h];b=e.call(a,f),g.splice(h,1),h--}return b}),"function"==typeof c.formatArgs&&(g=c.formatArgs.apply(a,g));var i=e.log||c.log||console.log.bind(console);i.apply(a,g)}b.enabled=!1,e.enabled=!0;var f=c.enabled(a)?e:b;return f.namespace=a,f}function f(a){c.save(a);for(var b=(a||"").split(/[\s,]+/),d=b.length,e=0;d>e;e++)b[e]&&(a=b[e].replace(/\*/g,".*?"),"-"===a[0]?c.skips.push(new RegExp("^"+a.substr(1)+"$")):c.names.push(new RegExp("^"+a+"$")))}function g(){c.enable("")}function h(a){var b,d;for(b=0,d=c.skips.length;d>b;b++)if(c.skips[b].test(a))return!1;for(b=0,d=c.names.length;d>b;b++)if(c.names[b].test(a))return!0;return!1}function i(a){return a instanceof Error?a.stack||a.message:a}c=b.exports=e,c.coerce=i,c.disable=g,c.enable=f,c.enabled=h,c.humanize=a("ms"),c.names=[],c.skips=[],c.formatters={};var j,k=0},{ms:41}],41:[function(a,b,c){function d(a){if(a=""+a,!(a.length>1e4)){var b=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(a);if(b){var c=parseFloat(b[1]),d=(b[2]||"ms").toLowerCase();switch(d){case"years":case"year":case"yrs":case"yr":case"y":return c*l;case"days":case"day":case"d":return c*k;case"hours":case"hour":case"hrs":case"hr":case"h":return c*j;case"minutes":case"minute":case"mins":case"min":case"m":return c*i;case"seconds":case"second":case"secs":case"sec":case"s":return c*h;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return c}}}}function e(a){return a>=k?Math.round(a/k)+"d":a>=j?Math.round(a/j)+"h":a>=i?Math.round(a/i)+"m":a>=h?Math.round(a/h)+"s":a+"ms"}function f(a){return g(a,k,"day")||g(a,j,"hour")||g(a,i,"minute")||g(a,h,"second")||a+" ms"}function g(a,b,c){return b>a?void 0:1.5*b>a?Math.floor(a/b)+" "+c:Math.ceil(a/b)+" "+c+"s"}var h=1e3,i=60*h,j=60*i,k=24*j,l=365.25*k;b.exports=function(a,b){return b=b||{},"string"==typeof a?d(a):b["long"]?f(a):e(a)}},{}],42:[function(a,b,c){"use strict";function d(){}function e(a){if("function"!=typeof a)throw new TypeError("resolver must be a function");this.state=s,this.queue=[],this.outcome=void 0,a!==d&&i(this,a)}function f(a,b,c){this.promise=a,"function"==typeof b&&(this.onFulfilled=b,this.callFulfilled=this.otherCallFulfilled),"function"==typeof c&&(this.onRejected=c,this.callRejected=this.otherCallRejected)}function g(a,b,c){o(function(){var d;try{d=b(c)}catch(e){return p.reject(a,e)}d===a?p.reject(a,new TypeError("Cannot resolve promise with itself")):p.resolve(a,d)})}function h(a){var b=a&&a.then;return a&&"object"==typeof a&&"function"==typeof b?function(){b.apply(a,arguments)}:void 0}function i(a,b){function c(b){f||(f=!0,p.reject(a,b))}function d(b){f||(f=!0,p.resolve(a,b))}function e(){b(d,c)}var f=!1,g=j(e);"error"===g.status&&c(g.value)}function j(a,b){var c={};try{c.value=a(b),c.status="success"}catch(d){c.status="error",c.value=d}return c}function k(a){return a instanceof this?a:p.resolve(new this(d),a)}function l(a){var b=new this(d);return p.reject(b,a)}function m(a){function b(a,b){function d(a){g[b]=a,++h!==e||f||(f=!0,p.resolve(j,g))}c.resolve(a).then(d,function(a){f||(f=!0,p.reject(j,a))})}var c=this;if("[object Array]"!==Object.prototype.toString.call(a))return this.reject(new TypeError("must be an array"));var e=a.length,f=!1;if(!e)return this.resolve([]);for(var g=new Array(e),h=0,i=-1,j=new this(d);++i<e;)b(a[i],i);return j}function n(a){function b(a){c.resolve(a).then(function(a){f||(f=!0,p.resolve(h,a))},function(a){f||(f=!0,p.reject(h,a))})}var c=this;if("[object Array]"!==Object.prototype.toString.call(a))return this.reject(new TypeError("must be an array"));var e=a.length,f=!1;if(!e)return this.resolve([]);for(var g=-1,h=new this(d);++g<e;)b(a[g]);return h}var o=a("immediate"),p={},q=["REJECTED"],r=["FULFILLED"],s=["PENDING"];b.exports=c=e,e.prototype["catch"]=function(a){return this.then(null,a)},e.prototype.then=function(a,b){if("function"!=typeof a&&this.state===r||"function"!=typeof b&&this.state===q)return this;var c=new this.constructor(d);if(this.state!==s){var e=this.state===r?a:b;g(c,e,this.outcome)}else this.queue.push(new f(c,a,b));return c},f.prototype.callFulfilled=function(a){p.resolve(this.promise,a)},f.prototype.otherCallFulfilled=function(a){g(this.promise,this.onFulfilled,a)},f.prototype.callRejected=function(a){p.reject(this.promise,a)},f.prototype.otherCallRejected=function(a){g(this.promise,this.onRejected,a)},p.resolve=function(a,b){var c=j(h,b);if("error"===c.status)return p.reject(a,c.value);var d=c.value;if(d)i(a,d);else{a.state=r,a.outcome=b;for(var e=-1,f=a.queue.length;++e<f;)a.queue[e].callFulfilled(b)}return a},p.reject=function(a,b){a.state=q,a.outcome=b;for(var c=-1,d=a.queue.length;++c<d;)a.queue[c].callRejected(b);return a},c.resolve=k,c.reject=l,c.all=m,c.race=n},{immediate:43}],43:[function(a,b,c){(function(a){"use strict";function c(){k=!0;for(var a,b,c=l.length;c;){for(b=l,l=[],a=-1;++a<c;)b[a]();c=l.length}k=!1}function d(a){1!==l.push(a)||k||e()}var e,f=a.MutationObserver||a.WebKitMutationObserver;if(f){var g=0,h=new f(c),i=a.document.createTextNode("");h.observe(i,{characterData:!0}),e=function(){i.data=g=++g%2}}else if(a.setImmediate||"undefined"==typeof a.MessageChannel)e="document"in a&&"onreadystatechange"in a.document.createElement("script")?function(){var b=a.document.createElement("script");b.onreadystatechange=function(){c(),b.onreadystatechange=null,b.parentNode.removeChild(b),b=null},a.document.documentElement.appendChild(b)}:function(){setTimeout(c,0)};else{var j=new a.MessageChannel;j.port1.onmessage=c,e=function(){j.port2.postMessage(0)}}var k,l=[];b.exports=d}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],44:[function(a,b,c){"use strict";function d(){this.store={}}function e(a){if(this.store=new d,a&&Array.isArray(a))for(var b=0,c=a.length;c>b;b++)this.add(a[b])}c.Map=d,c.Set=e,d.prototype.mangle=function(a){if("string"!=typeof a)throw new TypeError("key must be a string but Got "+a);return"$"+a},d.prototype.unmangle=function(a){return a.substring(1)},d.prototype.get=function(a){var b=this.mangle(a);return b in this.store?this.store[b]:void 0},d.prototype.set=function(a,b){var c=this.mangle(a);return this.store[c]=b,!0},d.prototype.has=function(a){var b=this.mangle(a);return b in this.store},d.prototype["delete"]=function(a){var b=this.mangle(a);return b in this.store?(delete this.store[b],!0):!1},d.prototype.forEach=function(a){for(var b=Object.keys(this.store),c=0,d=b.length;d>c;c++){var e=b[c],f=this.store[e];e=this.unmangle(e),a(f,e)}},e.prototype.add=function(a){return this.store.set(a,!0)},e.prototype.has=function(a){return this.store.has(a)},e.prototype["delete"]=function(a){return this.store["delete"](a)}},{}],45:[function(a,b,c){"use strict";function d(a,b,c){var d=c[c.length-1];a===d.element&&(c.pop(),d=c[c.length-1]);var e=d.element,f=d.index;if(Array.isArray(e))e.push(a);else if(f===b.length-2){var g=b.pop();e[g]=a}else b.push(a)}c.stringify=function(a){var b=[];b.push({obj:a});for(var c,d,e,f,g,h,i,j,k,l,m,n="";c=b.pop();)if(d=c.obj,e=c.prefix||"",f=c.val||"",n+=e,f)n+=f;else if("object"!=typeof d)n+="undefined"==typeof d?null:JSON.stringify(d);else if(null===d)n+="null";else if(Array.isArray(d)){for(b.push({val:"]"}),g=d.length-1;g>=0;g--)h=0===g?"":",",b.push({obj:d[g],prefix:h});b.push({val:"["})}else{i=[];for(j in d)d.hasOwnProperty(j)&&i.push(j);for(b.push({val:"}"}),g=i.length-1;g>=0;g--)k=i[g],l=d[k],m=g>0?",":"",m+=JSON.stringify(k)+":",b.push({obj:l,prefix:m});b.push({val:"{"})}return n},c.parse=function(a){for(var b,c,e,f,g,h,i,j,k,l=[],m=[],n=0;;)if(b=a[n++],"}"!==b&&"]"!==b&&"undefined"!=typeof b)switch(b){case" ":case"	":case"\n":case":":case",":break;case"n":n+=3,d(null,l,m);break;case"t":n+=3,d(!0,l,m);break;case"f":n+=4,d(!1,l,m);break;case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":case"-":for(c="",n--;;){if(e=a[n++],!/[\d\.\-e\+]/.test(e)){n--;break}c+=e}d(parseFloat(c),l,m);break;case'"':for(f="",g=void 0,h=0;;){if(i=a[n++],'"'===i&&("\\"!==g||h%2!==1))break;f+=i,g=i,"\\"===g?h++:h=0}d(JSON.parse('"'+f+'"'),l,m);break;case"[":j={element:[],index:l.length},l.push(j.element),m.push(j);break;case"{":k={element:{},index:l.length},l.push(k.element),m.push(k);break;default:throw new Error("unexpectedly reached end of input: "+b)}else{if(1===l.length)return l.pop();d(l.pop(),l,m)}}},{}]},{},[1]);